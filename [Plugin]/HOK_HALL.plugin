#!name = 王者荣耀国际服大厅
#!desc = 王者荣耀海外版偏向香港地区，适合大陆及港澳台&东南亚地区玩家的规则。高精度使AI电脑无头像;玩家头像正常显示以进行区分真实玩家。
#!openUrl = https://apps.apple.com/app/id1619254071
#!author = Sign-in-or-sign-out
#!homepage = 
#!icon = 
#!select = 
#!input = 
#!tag = 王者荣耀
#!date = 2025-12-06 08:00:00

[Rule]
#反人机头像
URL-REGEX,"^https:\/\/res\.sgameglobal\.com\/Global\/Common\/UGUI\/SystemRes\/044_Idip\/PlayerHeadIcon\/\d{1,2}(_big)?\.png\?-?\d{7,10}$",DIRECT//内置默认(含高级)头像&HD
URL-REGEX,"^https:\/\/res\.sgameglobal\.com\/Global\/Common\/UGUI\/SystemRes\/044_Idip\/PlayerHeadIcon.*?",REJECT-IMG-NO-DROP//其余头像

URL-REGEX,"^https:\/\/static\.hok5v5\.com\/client\/upload\/hok\/avatar\/[0-9a-f]{32}\/[0-9A-Z]{32}\d{14}\.jpg$",DIRECT//玩家上传头像
URL-REGEX,"^https://camp\.honorofkings\.com/client/upload/hok/circle/\d{19}/[0-9A-F]{32}\.jpg$",DIRECT//王者营地头像

#人机首字母头像
AND,((USER-AGENT,"Honor%20of%20Kings*"),(URL-REGEX,"^https:\/\/lh3\.googleusercontent\.com\/a\/ACg8oc[0-9a-zA-Z_-]{48,54}=s96-c$")),PROXY
AND,((USER-AGENT,"Honor%20of%20Kings*"),(URL-REGEX,"^https:\/\/yt3\.ggpht\.com\/ytc\/AL5GRJ.*?=s128$")),REJECT-IMG-NO-DROP
#fb头像
AND,((USER-AGENT,"Honor%20of%20Kings*"),(URL-REGEX,"^https:\/\/platform-lookaside\.fbsbx\.com\/platform\/profilepic\/\?asid=\d{15,17}&gaming_photo_type=unified_picture&ext=\d{10}&hash=AT[0-9a-zA-Z_-]{21,23}$")),PROXY

#人机头像
AND,((USER-AGENT,"Honor%20of%20Kings*"),(URL-REGEX,"^https:\/\/ogdb-cdn\.intlgame\.cn\/google_turkey\/\d{10,13}-[0-9a-fA-F]{12}\.png$")),REJECT-IMG-NO-DROP
AND,((USER-AGENT,"Honor%20of%20Kings*"),(URL-REGEX,"^https:\/\/ogdb-cdn\.intlgame\.cn\/draw\/a\/\d{6}_\d{6,9}\.png$")),REJECT-IMG-NO-DROP
DOMAIN,ogdb-cdn.intlgame.cn,DIRECT

AND,((USER-AGENT,"Honor%20of%20Kings*"),(URL-REGEX,"^https:\/\/static\.hok5v5\.com\/client\/upload\/hok\/avatar\/\d{19,20}\/[0-9a-zA-Z]{65,67}_100\.png$")),REJECT-IMG-NO-DROP
#AND,((USER-AGENT,"Honor%20of%20Kings*"),(URL-REGEX,"^https:\/\/static\.hok5v5\.com\/client\/upload\/hok\/avatar\/\d{19,20}\/[0-9a-zA-Z]{66}_100\.png$")),REJECT
#AND,((USER-AGENT,"Honor%20of%20Kings*"),(URL-REGEX,"^https:\/\/static\.hok5v5\.com\/client\/upload\/hok\/avatar\/\d{19,20}\/[0-9a-zA-Z]{65}_100\.png$")),REJECT
AND,((USER-AGENT,"Honor%20of%20Kings*"),(URL-REGEX,"^https:\/\/static\.hok5v5\.com\/client\/upload\/hok\/avatar\/\d{19,20}\/[0-9A-F]{32}_100\.png$")),REJECT-IMG-NO-DROP
AND,((USER-AGENT,"Honor%20of%20Kings*"),(URL-REGEX,"^https:\/\/static\.hok5v5\.com\/client\/upload\/hok\/avatar\/\d{19,20}\/.*?_100\.png$")),REJECT-IMG-NO-DROP
AND,((USER-AGENT,"Honor%20of%20Kings*"),(URL-REGEX,"^https:\/\/static\.hok5v5\.com\/client\/upload\/hok\/avatar\/\d{19,20}\/\d{6}\.png$")),REJECT-IMG-NO-DROP
DOMAIN,static.hok5v5.com,DIRECT

#拦截开屏
AND,((USER-AGENT,"Honor%20of%20Kings*"),(DOMAIN,v2-down-gamelet.sgameglobal.com)),REJECT-IMG-NO-DROP

#验证客户端版本可用
DOMAIN,download.2.687247097.tcloud-sg.sgameglobal.com,DIRECT
IP-CIDR,43.159.112.93/32,DIRECT,no-resolve
IP-CIDR,43.159.113.93/32,DIRECT,no-resolve

DOMAIN,download.2.687247097.hokglobalgcloud.iegcom.com,DIRECT
IP-CIDR,43.132.138.111/32,DIRECT

#进游戏相关
AND,((IP-CIDR,43.132.138.111/32,no-resolve),(DEST-PORT,20000)),DIRECT
AND,((IP-CIDR,162.62.221.120/32,no-resolve),(DEST-PORT,20000)),DIRECT
AND,((IP-ASN,132203,no-resolve),(DEST-PORT,20000)),DIRECT

AND,((DOMAIN,hokgcloudv6.iegcom.com),(DEST-PORT,20000)),DIRECT
AND,((IP-CIDR,119.28.121.50/32,no-resolve),(DEST-PORT,20000)),DIRECT

#反作弊检测？
AND,((DOMAIN,asia.cschannel.anticheatexpert.com),(OR,((DEST-PORT,443),(DEST-PORT,443),(DEST-PORT,10012))),(PROTOCOL,TCP)),REJECT-NO-DROP
AND,((IP-CIDR,101.32.143.64/32),(OR,((DEST-PORT,80),(DEST-PORT,443),(DEST-PORT,10012))),(PROTOCOL,TCP)),REJECT-NO-DROP
AND,((IP-CIDR,101.32.143.142/32),(OR,((DEST-PORT,80),(DEST-PORT,443),(DEST-PORT,10012))),(PROTOCOL,TCP)),REJECT-NO-DROP
AND,((IP-CIDR,101.32.143.232/32),(OR,((DEST-PORT,80),(DEST-PORT,443),(DEST-PORT,10012))),(PROTOCOL,TCP)),REJECT-NO-DROP
AND,((IP-CIDR,101.32.143.247/32),(OR,((DEST-PORT,80),(DEST-PORT,443),(DEST-PORT,10012))),(PROTOCOL,TCP)),REJECT-NO-DROP
AND,((IP-CIDR,129.226.1.157/32),(OR,((DEST-PORT,80),(DEST-PORT,443),(DEST-PORT,10012))),(PROTOCOL,TCP)),REJECT-NO-DROP
AND,((IP-CIDR,129.226.2.37/32),(OR,((DEST-PORT,80),(DEST-PORT,443),(DEST-PORT,10012))),(PROTOCOL,TCP)),REJECT-NO-DROP

AND,((IP-CIDR,119.28.121.174/32,no-resolve),(OR,((DEST-PORT,80),(DEST-PORT,443),(DEST-PORT,10012))),(PROTOCOL,TCP)),REJECT-NO-DROP
AND,((IP-CIDR,150.109.0.38/32,no-resolve),(OR,((DEST-PORT,80),(DEST-PORT,443),(DEST-PORT,10012))),(PROTOCOL,TCP)),REJECT-NO-DROP
AND,((IP-CIDR,150.109.0.45/32,no-resolve),(OR,((DEST-PORT,80),(DEST-PORT,443),(DEST-PORT,10012))),(PROTOCOL,TCP)),REJECT-NO-DROP
AND,((IP-CIDR,150.109.29.150/32,no-resolve),(OR,((DEST-PORT,80),(DEST-PORT,443),(DEST-PORT,10012))),(PROTOCOL,TCP)),REJECT-NO-DROP
#AND,((IP-ASN,132203),(GEOIP,SG),(OR,((DEST-PORT,80),(DEST-PORT,443),(DEST-PORT,10012))),(PROTOCOL,TCP)),REJECT-NO-DROP

#进大厅相关
AND,((DOMAIN,757117d71aacf773.sgameglobal.com.acc.edgeonedy1.com),(DEST-PORT,8801),(PROTOCOL,TCP)),DIRECT
AND,((IP-CIDR,43.134.243.97/32),(DEST-PORT,8801),(PROTOCOL,TCP)),PROXY
AND,((IP-CIDR,43.134.243.98/32),(DEST-PORT,8801),(PROTOCOL,TCP)),PROXY
AND,((IP-CIDR,43.134.243.99/32),(DEST-PORT,8801),(PROTOCOL,TCP)),PROXY

AND,((DOMAIN,757117d71aacf773.sgameglobal.com.acc.edgeonedy1.com),(DEST-PORT,10001-10038),(PROTOCOL,TCP)),PROXY
AND,((IP-CIDR,43.175.75.135/32),(DEST-PORT,10001-10038),(PROTOCOL,TCP)),PROXY
AND,((IP-CIDR,43.175.103.172/32),(DEST-PORT,10001-10038),(PROTOCOL,TCP)),PROXY

AND,((DOMAIN,online.sgameglobal.com),(DEST-PORT,10001-10038),(PROTOCOL,TCP)),PROXY
AND,((IP-CIDR,43.134.243.35/32),(DEST-PORT,10001-10038),(PROTOCOL,TCP)),PROXY
AND,((IP-CIDR,43.134.243.36/32),(DEST-PORT,10001-10038),(PROTOCOL,TCP)),PROXY
AND,((IP-CIDR,43.134.243.37/32),(DEST-PORT,10001-10038),(PROTOCOL,TCP)),PROXY
AND,((IP-CIDR,43.134.243.38/32),(DEST-PORT,10001-10038),(PROTOCOL,TCP)),PROXY
AND,((IP-CIDR,43.134.243.39/32),(DEST-PORT,10001-10038),(PROTOCOL,TCP)),PROXY
AND,((IP-CIDR,43.134.243.95/32),(DEST-PORT,10001-10038),(PROTOCOL,TCP)),PROXY
AND,((IP-CIDR,43.134.243.96/32),(DEST-PORT,10001-10038),(PROTOCOL,TCP)),PROXY
AND,((IP-CIDR,43.134.243.97/32),(DEST-PORT,10001-10038),(PROTOCOL,TCP)),PROXY
AND,((IP-CIDR,43.134.243.98/32),(DEST-PORT,10001-10038),(PROTOCOL,TCP)),PROXY
AND,((IP-CIDR,43.134.243.99/32),(DEST-PORT,10001-10038),(PROTOCOL,TCP)),PROXY
AND,((IP-ASN,132203,no-resolve),(GEOIP,SG,no-resolve),(DEST-PORT,10001-10038),(PROTOCOL,TCP)),PROXY

AND,((DOMAIN,online.sgameglobal.com),(PROTOCOL,TCP)),REJECT-NO-DROP
AND,((IP-CIDR,43.134.243.97/32),(PROTOCOL,TCP)),REJECT-NO-DROP
AND,((IP-CIDR,43.134.243.98/32),(PROTOCOL,TCP)),REJECT-NO-DROP
AND,((IP-CIDR,43.134.243.99/32),(PROTOCOL,TCP)),REJECT-NO-DROP


